(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{24:function(e,t,a){e.exports=a.p+"static/media/logo.a56cd5e0.svg"},26:function(e,t,a){e.exports=a.p+"static/media/success-icon.e38b395c.svg"},27:function(e,t,a){e.exports=a.p+"static/media/fail-icon.4072126c.svg"},29:function(e,t,a){e.exports=a(40)},34:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(23),r=a.n(c),i=(a(34),a(28)),l=a(1),s=a(14),u=a(15),p=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(s.a)(this,e),this.baseUrl=a,this.headers=n}return Object(u.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}},{key:"getItems",value:function(e){var t=this;return fetch(this.baseUrl.concat(e),{headers:this.headers}).then((function(e){return t._getResponseData(e)}))}},{key:"createItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(t),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return a._getResponseData(e)}))}},{key:"changeItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(t),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return a._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.replaceItem("cards/likes",e):this.deleteItem("cards/likes",e)}},{key:"replaceItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(e).concat("/".concat(t)),{method:"PUT",headers:this.headers}).then((function(e){return a._getResponseData(e)}))}},{key:"deleteItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(e).concat("/".concat(t)),{method:"DELETE",headers:this.headers}).then((function(e){return a._getResponseData(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/".concat("cohort-14","/"),headers:{authorization:"3829caf2-6683-412f-9e00-d0870fcd1817","Content-Type":"application/json"}}),m=a(24),_=a.n(m),d=a(2),f=a(6);var h=function(e){var t=e.onSignOut,a=e.userEmail.email;return o.a.createElement("header",{className:"header page__header section"},o.a.createElement("a",{href:"/",className:"logo header__logo"},o.a.createElement("img",{className:"logo__image",src:_.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 Mesto"})),o.a.createElement(d.d,null,o.a.createElement(d.b,{path:"/sign-up"},o.a.createElement(f.b,{to:"./sign-in",className:"link header__link"},"\u0412\u0445\u043e\u0434")),o.a.createElement(d.b,{path:"/sign-in"},o.a.createElement(f.b,{to:"./sign-up",className:"link header__link"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),o.a.createElement(d.b,{path:"/"},o.a.createElement("div",{className:"header__user-info"},o.a.createElement("p",{className:"header__email"},a),o.a.createElement("button",{onClick:t,className:"header__button"},"\u0412\u044b\u0439\u0442\u0438")))))},v=a(16),b=o.a.createContext();function E(e){var t=e.onCardClick,a=e.card,n=e.onCardLike,c=e.onCardDelete,r=e.owner,i=e.likes,l=e.name,s=e.link;var u=o.a.useContext(b),p=r._id===u._id,m=i.some((function(e){return e._id===u._id}))?"place__like-button place__like-button_active":"place__like-button";return o.a.createElement("li",{className:"places__item"},o.a.createElement("figure",{className:"place"},o.a.createElement("button",{className:p?"link place__delete-button":"link place__delete-button place__delete-button_disabled",onClick:function(e){var t=e.target.closest(".places__item");c(a,t)}}),o.a.createElement("img",{src:s,alt:l,className:"place__image",onClick:function(){t(a)}}),o.a.createElement("div",{className:"place__wrapper"},o.a.createElement("h2",{className:"place__name"},l," "),o.a.createElement("button",{className:"place__like-button-container"},o.a.createElement("div",{className:m,onClick:function(){n(a)}}),o.a.createElement("div",{className:"place__like-counter"},i.length)))))}var g=function(e){var t=e.onEditProfile,a=e.onAddPlace,n=e.onEditAvatar,c=e.handleCardClick,r=e.cards,i=e.onCardLike,l=e.onCardDelete,s=(Object(v.a)(e,["onEditProfile","onAddPlace","onEditAvatar","handleCardClick","cards","onCardLike","onCardDelete"]),o.a.useContext(b));return o.a.createElement("main",{className:"content page__content section"},o.a.createElement("section",{className:"profile section"},o.a.createElement("div",{className:"profile__image",onClick:n,style:{backgroundImage:"url(".concat(s.avatar,")")}}),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__name-wrap"},o.a.createElement("h1",{className:"profile__name"},s.name),o.a.createElement("button",{className:"link profile__edit-button",onClick:t})),o.a.createElement("p",{className:"profile__job"},s.about)),o.a.createElement("button",{className:"link profile__add-button",onClick:a})),o.a.createElement("section",{className:"places section"},o.a.createElement("ul",{className:"places__list"},o.a.createElement("li",{className:"places__empty-list"},"\u041d\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0441\u0442"),r.map((function(e){return o.a.createElement(E,Object.assign({key:e._id,onCardClick:c,card:e,onCardLike:i,onCardDelete:l},e))})))))};var k=function(){return o.a.createElement("footer",{className:"footer section page__footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},y={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:".popup__input-error",errorActiveClass:"popup__input-error_active",controlSelector:".popup__label"};var O=function(){function e(t,a){Object(s.a)(this,e),this._formSelectorsObj=t,this._formElement=a,this._inputList=Array.from(a.querySelectorAll(t.inputSelector)),this._buttonElement=a.querySelector(t.submitButtonSelector),this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorActiveClass=t.errorActiveClass,this._controlSelector=t.controlSelector}return Object(u.a)(e,[{key:"_findInputError",value:function(e){return e.closest(this._controlSelector).querySelector(this._inputErrorClass)}},{key:"_showInputError",value:function(e,t){var a=this._findInputError(e);a.textContent=t,a.classList.add(this._errorActiveClass)}},{key:"_hideInputError",value:function(e){var t=this._findInputError(e);t.classList.remove(this._errorActiveClass),t.textContent=""}},{key:"_isInputWithoutSpacingInvalid",value:function(e){var t=e.value.trim();return 0===t.length?1:t.length<2?2:0}},{key:"_checkInputValidity",value:function(e){var t=this._findInputError(e);switch(this._isInputWithoutSpacingInvalid(e)){case 1:t.textContent="\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u044d\u0442\u043e \u043f\u043e\u043b\u0435.",t.classList.add(this._errorActiveClass);break;case 2:t.textContent="\u0422\u0435\u043a\u0441\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 2 \u0441\u0438\u043c\u0432. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: 1 \u0441\u0438\u043c\u0432\u043e\u043b.",t.classList.add(this._errorActiveClass);break;case 0:e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage);break;default:alert("error")}}},{key:"hasInvalidInput",value:function(){var e=this;return this._inputList.some((function(t){return!t.validity.valid||e._isInputWithoutSpacingInvalid(t)}))}},{key:"_toggleButtonState",value:function(){this.hasInvalidInput()?this._buttonElement.classList.add(this._inactiveButtonClass):this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"_setEventListeners",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}}]),e}();var N=function(e){var t=e.title,a=e.name,n=e.buttonText,c=e.isOpen,r=e.onClose,i=e.onSubmit,l=e.children;function s(){if(c){var e=document.querySelector(".popup__form_type_".concat(a)),t=new O(y,e);return t.enableValidation(),!t.hasInvalidInput()}}function u(){document.querySelector(".popup__form_type_".concat(a)).reset(),r(),window.removeEventListener("keydown",p)}function p(e){"Escape"===e.key&&u()}return s(),c&&window.addEventListener("keydown",(function(e){return p(e)})),o.a.createElement("section",{className:"popup popup_type_form popup_type_".concat(a," ").concat(c&&"popup_opened"),onClick:function(e){e.target===e.currentTarget&&u()}},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{className:"link popup__close-button",onClick:u}),o.a.createElement("form",{className:"popup__form popup__form_type_".concat(a),noValidate:!0,name:a,onSubmit:function(e){e.preventDefault(),s()&&(i(e),document.querySelector(".popup__form_type_".concat(a)).reset())}},o.a.createElement("h2",{className:"popup__title"},t),o.a.createElement("fieldset",{className:"popup__fieldset"},l,o.a.createElement("button",{className:"link popup__save-button popup__save-button_type_".concat(a),autoFocus:!0,type:"submit"},n)))))};var C=function(e){var t=e.title,a=e.name,n=e.card,c=e.cardDOM,r=e.buttonText,i=e.isOpen,l=e.onClose,s=e.onCardDeleteSubmit;return o.a.createElement(N,{title:t,name:a,buttonText:r,isOpen:i,onClose:l,onSubmit:function(e){e.preventDefault(),s(n,c)}})};var j=function(e){var t=e.card,a=e.onClose,n=e.isOpen,c=e.name;function r(){a(),window.removeEventListener("keydown",i)}function i(e){"Escape"===e.key&&r()}return t?(window.addEventListener("keydown",i),o.a.createElement("section",{className:"popup popup_type_".concat(c," ").concat(n&&"popup_opened"),onClick:function(e){e.target===e.currentTarget&&r()}},o.a.createElement("div",{className:"popup__container-pic-zoom"},o.a.createElement("button",{className:"link popup__close-button",onClick:r}),o.a.createElement("figure",{className:"picture-zoom"},o.a.createElement("img",{src:t.link,alt:t.name,className:"picture-zoom__img"}),o.a.createElement("p",{className:"picture-zoom__title"},t.name))))):""};var S=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateUser,r=o.a.useContext(b),i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],p=s[1],m=Object(n.useState)(""),_=Object(l.a)(m,2),d=_[0],f=_[1];return Object(n.useEffect)((function(){p(r.name),f(r.about)}),[r]),o.a.createElement(N,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:function(){p(r.name),f(r.about),a()},onSubmit:function(e){e.preventDefault(),c({name:u,about:d})}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"text",value:u,onChange:function(e){p(e.target.value)},name:"profile-name",placeholder:"\u0418\u043c\u044f",id:"profile-name",className:"input popup__input popup__input_type_name",required:!0,minLength:"2",maxLength:"40"}),o.a.createElement("span",{className:"popup__input-error js-popup__input-error_type_profile"})),o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"text",value:d,onChange:function(e){f(e.target.value)},name:"profile-job",id:"profile-job",placeholder:"\u0420\u043e\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",className:"input popup__input popup__input_type_job",required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{className:"popup__input-error js-popup__input-error_type_profile"})))};var w=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateAvatar,r=Object(n.useRef)({}),i=Object(n.useState)(""),s=Object(l.a)(i,2),u=(s[0],s[1]);return o.a.createElement(N,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){c({avatar:r.current.value})}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{ref:r,onChange:function(e){u(e.target.value)},type:"url",name:"avatar",id:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"input popup__input popup__input_type_avatar",required:!0}),o.a.createElement("span",{className:"popup__input-error"})))};var L=function(e){var t=e.isOpen,a=e.onClose,c=e.onAddPlace,r=Object(n.useState)(""),i=Object(l.a)(r,2),s=i[0],u=i[1],p=Object(n.useState)(""),m=Object(l.a)(p,2),_=m[0],d=m[1];return o.a.createElement(N,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-place",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:function(){u(""),d(""),a()},onSubmit:function(e){e.preventDefault(),c({name:s,link:_}),u(""),d("")}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"text",value:s,onChange:function(e){u(e.target.value)},name:"place-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"place-name",className:"input popup__input popup__input_type_place-name",required:!0,minLength:"2",maxLength:"30"}),o.a.createElement("span",{className:"popup__input-error"})),o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"url",value:_,onChange:function(e){d(e.target.value)},name:"place-pic",id:"place-pic",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"input popup__input popup__input_type_place-pic",required:!0}),o.a.createElement("span",{className:"popup__input-error"})))},I=a(9),x=a(10);var A=function(e){var t=e.title,a=e.children,n=e.onSubmit;return o.a.createElement(o.a.Fragment,null,o.a.createElement("section",{className:"popup__register-login"},o.a.createElement("section",{className:"popup__container-register-login"},o.a.createElement("form",{className:"popup__form",noValidate:!0,onSubmit:n},o.a.createElement("h2",{className:"popup__title popup__title_type_login"},t),o.a.createElement("fieldset",{className:"popup__fieldset"},a)))))},T="https://auth.nomoreparties.co",D=function(e){var t=e.handleLogin,a=Object(n.useState)({email:"",password:""}),c=Object(l.a)(a,2),r=c[0],i=c[1],s=Object(d.g)(),u=Object(n.useState)(""),p=Object(l.a)(u,2),m=p[0],_=p[1],f=function(e){var t=e.target,a=t.name,n=t.value;i((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(I.a)({},a,n))}))};return o.a.createElement("div",{className:"login"},o.a.createElement(A,{title:"\u0412\u0445\u043e\u0434",onSubmit:function(e){e.preventDefault();var a=r.email,n=r.password;a&&n&&function(e,t){return fetch("".concat(T,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e||console.log("auth \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 email \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d : ".concat(e)),e||void 0})).catch((function(e){return console.log("auth authorize error: ".concat(e))}))}(a,n).then((function(e){e||_("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 Login!"),e.token&&(!function(e){localStorage.setItem("jwt",e)}(e.token),_(""),t(a),s.push("/"))})).then((function(){return i({email:"",password:""})})).catch((function(e){return console.log(e)}))}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"email",value:r.email,onChange:f,name:"email",placeholder:"Email",id:"email",className:"input popup__input popup__input_type_dark",required:!0,minLength:"2",maxLength:"320"}),o.a.createElement("span",{className:"popup__input-error"},m)),o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"password",value:r.password,onChange:f,name:"password",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"input popup__input popup__input_type_dark",required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{className:"popup__input-error"},m)),o.a.createElement("button",{className:"link popup__save-button popup__save-button_type_dark",autoFocus:!0,type:"submit"},"\u0412\u043e\u0439\u0442\u0438")))},q=function(e){var t=e.component,a=Object(v.a)(e,["component"]);return o.a.createElement(d.b,null,(function(){return!0===a.loggedIn?o.a.createElement(t,a):o.a.createElement(d.a,{to:"./sign-up"})}))},P=function(e){var t=e.handleRegisterSuccess,a=e.handleRegisterFail,c=e.infoTooltipOpen,r=Object(n.useState)({email:"",password:""}),i=Object(l.a)(r,2),s=i[0],u=i[1],p=Object(d.g)(),m=Object(n.useState)(""),_=Object(l.a)(m,2),h=_[0],v=_[1],b=function(e){var t=e.target,a=t.name,n=t.value;u((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(I.a)({},a,n))}))};return o.a.createElement("div",{className:"register"},o.a.createElement(A,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",onSubmit:function(e){e.preventDefault(),function(t,a){return fetch("".concat(T,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})}).then((function(t){try{if(201===t.status)return t.json()}catch(e){return e}})).then((function(e){return e})).catch((function(e){return console.log("auth register error: ".concat(e))}))}(s.email,s.password).then((function(e){e?e.data?(v(""),t(),c(),p.push("/sign-in")):400===e.status&&(v("\u041d\u0435\u0432\u0435\u0440\u043d\u043e \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 Register"),a(),c()):(v("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0432 Register"),a(),c())}))}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"email",value:s.email,onChange:b,name:"email",placeholder:"Email",id:"email",className:"input popup__input popup__input_type_dark",required:!0,minLength:"2",maxLength:"320"}),o.a.createElement("span",{className:"popup__input-error popup__input-error_active"},h)),o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"password",value:s.password,onChange:b,name:"password",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"input popup__input popup__input_type_dark",required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{className:"popup__input-error popup__input-error_active"},h)),o.a.createElement("button",{className:"link popup__save-button popup__save-button_type_dark",autoFocus:!0,type:"submit"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement(f.b,{to:"/sign-in",className:"link popup__login-link"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b? \u0412\u043e\u0439\u0442\u0438")))},U=a(26),R=a.n(U),B=a(27),z=a.n(B);var F=function(e){var t=e.isOpen,a=e.onClose,n=e.isSuccess;function c(){a(),window.removeEventListener("keydown",r)}function r(e){"Escape"===e.key&&c()}return t&&window.addEventListener("keydown",(function(e){return r(e)})),o.a.createElement(o.a.Fragment,null,o.a.createElement("section",{className:"popup popup_type_form ".concat(t&&"popup_opened"),onClick:function(e){e.target===e.currentTarget&&c()}},o.a.createElement("div",{className:"popup__container"},n?o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:R.a,alt:"\u0413\u0430\u043b\u043e\u0447\u043a\u0430",className:"popup__infotool-img"}),o.a.createElement("p",{className:"popup__infotool-text"},"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!")):o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:z.a,alt:"\u041a\u0440\u0430\u0441\u043d\u044b\u0439 \u043a\u0440\u0435\u0441\u0442\u0438\u043a",className:"popup__infotool-img"}),o.a.createElement("p",{className:"popup__infotool-text"},"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437!")),o.a.createElement("button",{className:"popup__close-button",onClick:a}))))};var J=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(!1),s=Object(l.a)(r,2),u=s[0],m=s[1],_=Object(n.useState)(!1),f=Object(l.a)(_,2),v=f[0],E=f[1],y=Object(n.useState)(!1),O=Object(l.a)(y,2),N=O[0],I=O[1],x=Object(n.useState)(!1),A=Object(l.a)(x,2),U=A[0],R=A[1],B=Object(n.useState)(!1),z=Object(l.a)(B,2),J=z[0],M=z[1],V=Object(n.useState)([]),W=Object(l.a)(V,2),G=W[0],H=W[1],$=Object(n.useState)({name:"\u0416\u0430\u043a \u0418\u0432 \u041a\u0443\u0441\u0442\u043e",about:"\u041c\u043e\u0440\u0435\u043f\u043b\u0430\u0432\u0430\u0442\u0435\u043b\u044c",avatar:"https://kaskad.tv/images/2020/foto_zhak_iv_kusto__-_interesnie_fakti_20190810_2078596433.jpg"}),K=Object(l.a)($,2),Q=K[0],X=K[1],Y=Object(n.useState)(),Z=Object(l.a)(Y,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(),ne=Object(l.a)(ae,2),oe=ne[0],ce=ne[1],re=Object(n.useState)({email:""}),ie=Object(l.a)(re,2),le=ie[0],se=ie[1],ue=Object(n.useState)(!1),pe=Object(l.a)(ue,2),me=pe[0],_e=pe[1],de=Object(d.g)(),fe=Object(n.useState)(!1),he=Object(l.a)(fe,2),ve=he[0],be=he[1];function Ee(){!function(){var e=document.querySelectorAll(".popup__input-error");e&&e.forEach((function(e){return e.classList.remove("popup__input-error_active")}))}(),E(!1),c(!1),m(!1),te(),I(!1),R(!1),ce(),M(!1)}function ge(e,t,a){t.textContent=e?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":a}Object(n.useEffect)((function(){Promise.all([p.getItems("users/me"),p.getItems("cards")]).then((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];X(a);var o=n.map((function(e){return{name:e.name,link:e.link,_id:e._id,likes:e.likes,owner:e.owner}}));H(o)})).catch((function(e){console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a: ".concat(e))}))}),[]);var ke=function(){var e=localStorage.getItem("jwt");e&&function(e){return fetch("".concat(T,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))}(e).then((function(e){if(e){var t={email:e.data.email};_e(!0),se(t),de.push("/")}}))};return Object(n.useEffect)((function(){ke()}),[]),o.a.createElement("div",{className:"page"},o.a.createElement("div",{className:"page__container"},o.a.createElement(b.Provider,{value:Q},o.a.createElement(h,{onSignOut:function(){localStorage.removeItem("jwt"),de.push("/sign-in")},userEmail:le}),o.a.createElement(d.d,null,o.a.createElement(d.b,{path:"/sign-in"},o.a.createElement(D,{handleLogin:function(e){se({email:e}),_e(!0)}})),o.a.createElement(d.b,{path:"/sign-up"},o.a.createElement(P,{handleRegisterSuccess:function(){be(!0)},handleRegisterFail:function(){be(!1)},infoTooltipOpen:function(){M(!0)}})),o.a.createElement(q,{path:"/",loggedIn:me,onEditProfile:function(){c(!0)},onAddPlace:function(){m(!0)},onEditAvatar:function(){E(!0)},handleCardClick:function(e){te(e),R(!0)},cards:G,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===Q._id}));p.changeLikeCardStatus(e._id,!t).then((function(t){var a=G.map((function(a){return a._id===e._id?t:a}));H(a)})).catch((function(e){console.log("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043b\u0430\u0439\u043a\u0430: ".concat(e))}))},onCardDelete:function(e,t){I(!0),te(e),ce(t)},component:g})),me&&o.a.createElement(k,null),o.a.createElement(F,{isOpen:J,onClose:Ee,isSuccess:ve}),o.a.createElement(S,{isOpen:a,onClose:Ee,onUpdateUser:function(e){var t=document.querySelector(".popup__save-button_type_edit-profile");ge(!0,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),p.changeItem({name:e.name.trim(),about:e.about.trim()},"users/me").then((function(e){X(e)})).then((function(){Ee()})).catch((function(e){console.log("\u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435: ".concat(e))})).finally((function(){ge(!1,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))}}),o.a.createElement(L,{isOpen:u,onClose:Ee,onAddPlace:function(e){var t=document.querySelector(".popup__save-button_type_add-place");ge(!0,t,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),p.createItem(e,"cards").then((function(e){H([e].concat(Object(i.a)(G)))})).then((function(){Ee()})).catch((function(e){console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){ge(!1,t,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}))}}),o.a.createElement(w,{isOpen:v,onClose:Ee,onUpdateAvatar:function(e){var t=document.querySelector(".popup__save-button_type_edit-avatar");ge(!0,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),p.changeItem({avatar:e.avatar},"users/me/avatar").then((function(e){X(e),document.querySelector(".profile__image").style.backgroundImage="url('".concat(e.avatar,"')")})).then((function(){Ee()})).catch((function(e){console.log("\u041f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f: ".concat(e))})).finally((function(){ge(!1,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))}}),o.a.createElement(C,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"card-delete",card:ee,cardDOM:oe,buttonText:"\u0414\u0430",isOpen:N,onClose:Ee,onCardDeleteSubmit:function(e,t){var a=document.querySelector(".popup__save-button_type_card-delete");ge(!0,a,"\u0414\u0430"),p.deleteItem("cards",e._id).then((function(){t.remove()})).then((function(){Ee()})).catch((function(e){console.log("\u041f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){return ge(!1,a,"\u0414\u0430")}))}}),o.a.createElement(j,{name:"picture-zoom",isOpen:U,card:ee,onClose:Ee}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(f.a,null,o.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[29,1,2]]]);
//# sourceMappingURL=main.15046cec.chunk.js.map